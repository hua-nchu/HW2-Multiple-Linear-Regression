# HW2：多元線性回歸分析與 CRISP-DM 流程實作報告 v3

## 一、前言：資料集來源與研究脈絡

### 1.1 資料集來源
本專案選用的資料集為來自 Kaggle 的 **"Cyber Security Attacks"**。
- **Kaggle 連結：** [https://www.kaggle.com/datasets/shashwatwork/cyber-security-attacks](https://www.kaggle.com/datasets/shashwatwork/cyber-security-attacks)
- **資料集摘要：** 此資料集包含 40,000 筆網路攻擊事件的詳細記錄，共 25 個特徵，涵蓋了網路流量的各個面向，例如來源/目的 IP、埠號、協議、攻擊類型、嚴重性等。

### 1.2 研究脈絡與目的
在當今數位化的世界中，網路安全已成為至關重要的議題。能夠即時偵測並評估網路攻擊的風險，對於保護系統與資料至關重要。本研究旨在利用機器學習方法，對真實世界的網路攻擊資料進行分析，並建立一個預測模型。

本專案的核心目標是**預測網路事件的 `Anomaly Scores` (異常分數)**。這個分數可以被視為一個量化的風險指標，分數越高，代表該事件越可疑或越危險。透過建立一個準確的預測模型，我們期望能輔助安全分析師快速識別高風險事件，從而有效地分配資源並及時應對潛在威脅。

本報告將遵循 CRISP-DM (跨產業資料探勘標準流程) 的六大步驟，完整呈現從商業理解到模型部署的整個分析過程。

---

## 二、CRISP-DM 分析流程

### 階段一：商業理解 (Business Understanding)
- **核心目標：** 建立一個多元線性回歸模型，以預測網路事件的 `Anomaly Scores`。
- **應用情境：** 開發一個自動化工具，輔助安全分析師判斷網路事件的風險等級。高 `Anomaly Scores` 的事件將被標記為高優先級，需要立即審查。
- **成功標準：** 模型的 R² (決定係數) 應顯著大於 0，表示模型具有一定的解釋能力。RMSE (均方根誤差) 和 MAE (平均絕對誤差) 應盡可能低。

### 階段二：資料理解 (Data Understanding)
- **初步探索：** 透過 `pandas` 套件對資料進行初步分析。發現資料集中包含數值與類別兩種特徵。
- **目標變數分析：** 目標變數 `Anomaly Scores` 為 0 到 100 之間的連續浮點數，分佈相對均勻，適合進行回歸分析。
- **缺失值問題：** 發現 `Malware Indicators`, `Alerts/Warnings`, `Proxy Information` 等多個欄位存在超過 50% 的缺失值，這在後續的資料準備階段需要特別處理。

### 階段三：資料準備 (Data Preparation)
- **缺失值處理：** 考量到缺失比例過高，且填補困難，決定直接刪除具有大量缺失值的欄位。
- **特徵工程與選擇：**
    - 刪除了對於線性模型難以處理的高基數特徵 (如 IP 位址、使用者資訊) 和不相關特徵 (如時間戳)。
    - 對於剩餘的類別特徵 (如 `Protocol`, `Attack Type`) 進行獨熱編碼 (One-Hot Encoding)，將其轉換為模型可以理解的數值格式。
- **資料分割與縮放：**
    - 將資料集以 80:20 的比例分割為訓練集與測試集。
    - 為了讓後續的 Lasso 正規化能公平對待所有特徵，使用 `StandardScaler` 對特徵進行標準化。

### 階段四：建模 (Modeling)
- **模型選擇：** 根據作業要求，選擇**多元線性回歸 (Multiple Linear Regression)** 作為主要模型。
- **特徵選擇方法：** 為了從眾多特徵中找出對預測 `Anomaly Scores` 最有影響力的因子，採用了 **Lasso (L1) 正規化**。Lasso 能夠在訓練過程中將不重要的特徵係數縮減至零，從而達到自動化特徵選擇的效果。
- **模型訓練：**
    1.  首先，訓練一個 Lasso 模型以識別重要的特徵。
    2.  接著，僅使用 Lasso 所選出的特徵，訓練一個最終的多元線性回歸模型。

### 階段五：評估 (Evaluation)
- **評估指標：** 使用 R-squared (R²), RMSE (均方根誤差), 和 MAE (平均絕對誤差) 來評估模型表現。
- **模型表現：**
    - **R-squared (R²): -0.0009**
    - **RMSE: 28.9136**
    - **MAE: 25.0148**
- **結果分析與說服力：**
    - **R² 值接近於零且為負**，這是一個關鍵的發現。它強而有力地說明，**目前的特徵與 `Anomaly Scores` 之間不存在顯著的線性關係**。換言之，簡單的線性模型無法捕捉此資料的複雜模式。
    - 這個「失敗」的結果本身極具說服力，它排除了使用簡單模型的可能性，並指引我們必須轉向更複雜的非線性模型才能解決問題。
    - 預測圖 `prediction_plot_with_intervals.png` 也直觀地證實了這一點：預測值散亂地分佈在實際值周圍，且預測區間非常寬，顯示模型對其預測結果缺乏信心。

### 階段六：部署 (Deployment)
- **產出交付：**
    - **程式碼：** `Multiple_LinearRegression.py` 包含完整的分析流程。
    - **預測圖：** `prediction_plot_with_intervals.png` 視覺化呈現了模型的預測結果與其不確定性。
- **最終結論與建議：**
    - **結論：** 對於此網路安全資料集，多元線性回歸模型 (即使結合了 Lasso 特徵選擇) 並不適用。
    - **未來方向 (根據 NotebookLM 摘要更新)：**
        1.  **採用高效能的非線性模型：** 如 NotebookLM 摘要所示，學術界與業界在處理類似的入侵偵測問題時，普遍採用如 **決策樹 (DT)、隨機森林 (RF)** 或 **XGBoost** 等集成學習模型。這些模型在處理高維度資料和捕捉複雜模式上表現卓越，應作為下一步研究的重點。
        2.  **實施更精確的特徵選擇：** 除了 Lasso，可以嘗試如 **隨機森林-遞歸特徵消除 (RF-RFE)**、**資訊增益 (Information Gain)** 或 **Gini Importance** 等方法來篩選特徵。目標是選出最具影響力的特徵子集，以提升模型效能並降低運算成本。
        3.  **重新評估問題定義：** 考慮將問題從回歸任務轉為分類任務，例如直接預測 `Attack Type`。這與許多成功的研究案例（如在 NSL-KDD 和 UNSW-NB15 資料集上的研究）相符，且可能更具實際應用價值。

---

## 三、GPT 對話與 NotebookLM 摘要

### 3.1 GPT 對話摘要
本次分析是透過與 Gemini 大型語言模型的互動逐步完成的。其過程大致如下：
1.  **初步探索：** 首先，我請 Gemini 讀取並分析 `cybersecurity_attacks.csv` 的基本資訊。
2.  **建立初始模型：** 根據初步理解，建立了一個基礎的多元線性回歸模型。然而，評估結果 (R² ≈ 0) 顯示模型無效。
3.  **模型修正與特徵選擇：** 根據我的要求，我們採用了更進階的 Lasso 正規化進行特徵選擇，並加入了預測區間的視覺化。
4.  **最終評估與報告撰寫：** 即使修正後，模型表現依然不佳。我們共同得出結論：線性模型不適用於此問題。最後，根據我的評分標準，Gemini 協助整理並產出了這份完整的 CRISP-DM 分析報告。
5.  **整合外部研究與深化結論：** 我提供了來自 NotebookLM 的研究摘要，Gemini 將其整合至報告中，並據此更新了「未來建議」，使結論更具說服力與參考價值。

### 3.2 NotebookLM 研究摘要
針對您的網路安全（如入侵偵測和惡意流量分類）主題，網路上的主流解決方案一致強調使用高效能的機器學習模型與精確的特徵選擇方法，以應對高維度流量資料的挑戰。

**摘要：** 多數研究採用決策樹 (DT)、隨機森林 (RF) 或 XGBoost 等非線性集成學習模型，這些模型在入侵偵測系統 (IDS) 的預測準確度上表現卓越。例如，有研究提出混合式集成模型 (ML ensemble) 結合隨機森林-遞歸特徵消除 (RF-RFE)，能在減少特徵數量的同時，於 NSL-KDD 和 UNSW-NB15 資料集上達到 98% 至 99% 以上的準確度。在特徵選擇方面，專家們採用資訊增益 (Information Gain)、Gini Importance、以及結合過濾法和包裝法的混合式特徵選擇（例如 皮爾森相關係數 (PCC) 結合基因演算法 (GA)）。這些技術的目標是選出最具影響力的特徵子集，從而大幅減少模型的運算時間，並避免因不相關或多餘特徵造成的效能下降。研究顯示，透過減少特徵數量（例如從 196 個減少到 47 個），反而能提升模型的預測能力。這與您在多元線性回歸實驗中觀察到的線性模型侷限性（R² 接近 0）形成了鮮明對比，有力地支持了應轉向更複雜非線性模型以捕捉資料間複雜模式的結論。
